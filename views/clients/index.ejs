
<%- include('../partials/infoMessages.ejs') %> 
<div class="center-main-div ">
    <div class="main-div toogleList">
        <div class="content  ">
            <div class="visit">
                    <form class="find-visit"  method="GET"  id="myform">
                        <input type="text" class="myInput myInputClient" name="name" value="<%=searchOptions.name%>" placeholder="Szukaj Klienta" autocomplete="off" >  
                        <input placeholder="Od" id="dataFrom" name="visitAfter"   autocomplete="off" value="<%=searchOptions.visitAfter%>" autocomplete="off" />
                        <button type="submit"><i class="fas fa-search"></i></button>
                        
            </form>
                  
            <!--onclick="showFormm()"-->
           <button  onclick="window.location='/clients/new'"  class="button_action showForm" >
            <i class="fas fa-plus"></i></button>
            </div>
           
      
        </div>
        <%-include('../partials/toogleListClients.ejs')%>
    </div>
</div>
<div class="main-div-full-content .main-div-toogle">
    <div class="main-div-center ">
        
            <div class="content-div">
                <% for(var i = 0 ; i< clients.length ; i++){%>
                  
                    <div class="visit">
            
                        <form method="post" action='/clients/<%=clients[i].id%>?_method=DELETE'>
                            <button type="submit" class="close" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                       
                      
                        <div   onclick="window.location='/clients/client-view/<%=clients[i].id%>'" >
                            <p client="<%=clients[i].name%> <%=clients[i].lastName%>">
                                <%=clients[i].name%> <%=clients[i].lastName%></p>
                            <p class="headerVisit">Telefon</p>
                            <p onclick=><%=clients[i].phoneNumber%></p>
                            <p class="headerVisit">Urodziny</p>                      
                            <p ><%=clients[i].dateOfBirth !=null ?clients[i].dateOfBirth.toISOString().split('T')[0] :'-'%></p>
                        </div>
                    </div> 
                   
                   
                <%} %> 
            </div>
        
     
    </div>
    <div class="company-square"><p class="p-color">Zakupy</p></div>
    <div class="square-shadow"></div>
    <div class="center-shopping-list">
        <div class="shopping-list">
            <%shoppingAll.forEach(element => {%>
                <div onclick="location.href='/shopping-list/list-view/<%=element._id%>'" class="list-content">
                    <div class="date">
                        <p><%= element.transactionDate == null ? '' : `${weekdays[element.transactionDate.getDay()]} ${element.transactionDate.toISOString().split('T')[0]}` %> </p> 
                    </div>
                    <div class="shopping-price-name">
                        <div class="list-name">
                            <p class="headerVisit">Nazwa</p>
                            <p><%= element.listName.name == null ? '' :element.listName.name %> </p> 
                        </div>
                        <div  class="list-price">
                            <p class="headerVisit">Cena</p>
                            <p class="last"><%= element.totalPrice %>zł </p>
                        </div>
                       
                    </div> 
                </div>
              
            
            <%}); %>
        </div>
    
    </div>

</div>


<footer class='footer'>
    <p>Copyright ® All rights reserved 2020  Karolina Wiaderek </p>
</footer>


<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
<script src="../../public/dataTimePicker.js"></script>
<script>
    $(document).ready(function(){
      $('.myInputClient').on('keyup click', function () {
            let value = $(this).val().toLowerCase();
           
            $('.main-div-full-content .visit ').filter(function(){
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            })

        })
        //if clients list clicked toggle visits
        $('.clients-list').on('click',function(){
            let value = $('.myInputClient').val().toLowerCase();
           
            $('.main-div-full-content .visit ').filter(function(){
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
           
            })  
        })
    })
</script>